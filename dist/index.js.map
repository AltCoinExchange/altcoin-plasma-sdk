{"version":3,"sources":["webpack:///dist/index.js","webpack:///webpack/bootstrap 21fd1e9f1fbd8a7d8bd5","webpack:///./src/main/main.ts","webpack:///external \"altcoin-ethereum-wallet\"","webpack:///./src/main/eth/ethereum-account.ts","webpack:///external \"eth-lib/lib/account\"","webpack:///external \"eth-lib/lib/hash\"","webpack:///external \"web3-utils\"","webpack:///external \"hdkey\"","webpack:///./src/main/services/ulotion.ts","webpack:///./src/main/services/ulotion-helper.ts","webpack:///external \"crypto-browserify\"","webpack:///external \"json-stable-stringify\"","webpack:///external \"signalhub\"","webpack:///external \"webrtc-swarm\"","webpack:///external \"varstruct\"","webpack:///external \"wrtc\"","webpack:///external \"axios\"","webpack:///external \"tendermint\"","webpack:///./src/main/config/main.config.ts","webpack:///./src/main/common/state-helper.ts","webpack:///./src/main/common/state-merge-patch.ts","webpack:///external \"jsondiffpatch\""],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__awaiter","this","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","verb","v","op","f","TypeError","_","y","t","label","ops","pop","trys","length","push","g","sent","throw","return","Symbol","iterator","_a","ethereum_account_1","ulotion_1","altcoin_ethereum_wallet_1","main_config_1","state_helper_1","state_merge_patch_1","altcoin_ethereum_wallet_2","TOKENS","TokenFactory","ERC20","EthEngine","EthereumWallet","TokenConfig","TokenConfigMain","generateMnemonic","AugurTokenTestnet","AugurTokenMainnet","TokenMapping","Augur","contractAddress","toLowerCase","AUGUR","Golem","GOLEM","Gnosis","GNOSIS","Bat","BAT","Aragon","ARAGON","Eos","EOS","Salt","SALT","Civic","CIVIC","OmiseGo","OMISEGO","District0x","DISTRICT0X","StatusNetwork","STATUSNETWORK","Substratum","SUBSTRATUM","Tron","TRON","Bytom","BYTOM","Dent","DENT","Populous","POPULOUS","Maker","MAKER","DigixDAO","DIGIXDAO","QASH","Ethos","ETHOS","FunFair","FUNFAIR","RequestNetwork","REQUESTNETWORK","Bancor","BANCOR","Iconomi","ICONOMI","TenXPay","TENXPAY","Storj","STORJ","EnjinCoin","ENJINCOIN","WETH","ZeroX","ZEROX","Bloom","BLOOM","Lunyr","LUNYR","Monaco","MONACO","TokenMappingReverse","prop","LightClient","GCI","options","privKey","ethConfig","ulotion","uLotion","App","eth","states","Map","getAccount","EthereumAccount","recoverAccount","authenticate","acc","engine","keystore","login","recoverAccountAndSignOrder","pkey","order","signature","signReceiptTendermint","payload","sender","sellToken","buyToken","sellAmount","buyAmount","nonce","r","messageHash","recoverAccountAndSignWithdraw","token","amount","wdto","signWithdrawTendermint","address","toString","refreshState","path","state","balance","StateHelper","mapAddressToEnum","accounts","JSON","parse","send","data","faucet","eng","tokenContract","GetToken","deposit","approvedResult","approve","DepositToken","currentDepositNonce","action","make","buyTokenObj","sellTokenObj","nonceState","signedOrder","_b","getActiveOrders","all","withdraw","withdrawToken","useLatestState","withdrawRequest","wConf","wRes","withdrawConfirmation","console","log","subscribe","func","subscribeMulti","_i","path_1","stateWatcher","that","evtHandler","evt","_this","StateMergePatch","set","forEach","key","diff","subscribeTx","require","Account","Hash","Web3Utils","HDKey","account","privateKey","recoverAccountFromSeed","seed","hdkey","fromMasterSeed","hdnode","derive","_privateKey","privateKeyToAccount","pk","fromPrivate","hexValue","hash","hashMessage","signHash","signReceipt","ticketNumber","Error","sign","val","asciiToHex","replace","vrs","decodeSignature","message","keccak256s","ulotion_helper_1","axios","tendermint","nodes","undefined","getGenesisActivePeer","rpcAddr","genesis","ulotionHelper","fetchGenesis","peer","host","tendermintPort","queryResponse","resp","error","stringify","response","height","Number","Buffer","from","tx","txBytes","params","rpc","RpcClient","eventRpc","on","query","crypto_browserify_1","stableStringify","signalhub","swarm","vstruct","TxStruct","type","VarString","UInt32BE","convertBase64ToBuffers","obj","bufferToBase64Replacer","base64ToBufferReplacer","startsWith","slice","encode","txData","sw","hub","process","wrtc","id","port","destroy","remoteAddress","createHash","update","digest","json","getGCIFromGenesis","genesisJson","genesis_time","genesisStr","deepClone","replacer","newObj","Array","isArray","assign","isBuffer","convertedObj","wshost","defaultWallet","main_1","arr","jsondiffpatch_1","dp","DiffPatcher","clone","lc","newState","currentState","patchToMergePatch","isNumeric","isNaN","parseFloat","isFinite","isChildArray","toObjType","handleValue","handleObj","patch"],"mappings":"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","file":"dist/index.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _a;\nvar ethereum_account_1 = __webpack_require__(2);\nvar ulotion_1 = __webpack_require__(7);\nvar altcoin_ethereum_wallet_1 = __webpack_require__(1);\nvar main_config_1 = __webpack_require__(17);\nvar state_helper_1 = __webpack_require__(18);\nvar state_merge_patch_1 = __webpack_require__(19);\n// Export wallet\nvar altcoin_ethereum_wallet_2 = __webpack_require__(1);\nexports.TOKENS = altcoin_ethereum_wallet_2.TOKENS;\nexports.TokenFactory = altcoin_ethereum_wallet_2.TokenFactory;\nexports.ERC20 = altcoin_ethereum_wallet_2.ERC20;\nexports.EthEngine = altcoin_ethereum_wallet_2.EthEngine;\nexports.EthereumWallet = altcoin_ethereum_wallet_2.EthereumWallet;\nexports.TokenConfig = altcoin_ethereum_wallet_2.TokenConfig;\nexports.TokenConfigMain = altcoin_ethereum_wallet_2.TokenConfigMain;\nexports.generateMnemonic = altcoin_ethereum_wallet_2.generateMnemonic;\nexports.AugurTokenTestnet = altcoin_ethereum_wallet_2.AugurTokenTestnet;\nexports.AugurTokenMainnet = altcoin_ethereum_wallet_2.AugurTokenMainnet;\n// TODO: Add dynamic tokens for easier adding new ones later\nexports.TokenMapping = (_a = {},\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Augur.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.AUGUR,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Golem.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.GOLEM,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Gnosis.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.GNOSIS,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Bat.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.BAT,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Aragon.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.ARAGON,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Eos.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.EOS,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Salt.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.SALT,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Civic.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.CIVIC,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.OmiseGo.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.OMISEGO,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.District0x.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.DISTRICT0X,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.StatusNetwork.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.STATUSNETWORK,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Substratum.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.SUBSTRATUM,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Tron.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.TRON,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Bytom.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.BYTOM,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Dent.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.DENT,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Populous.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.POPULOUS,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Maker.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.MAKER,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.DigixDAO.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.DIGIXDAO,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.QASH.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.QASH,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Ethos.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.ETHOS,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.FunFair.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.FUNFAIR,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.RequestNetwork.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.REQUESTNETWORK,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Bancor.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.BANCOR,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Iconomi.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.ICONOMI,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.TenXPay.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.TENXPAY,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Storj.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.STORJ,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.EnjinCoin.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.ENJINCOIN,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.WETH.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.WETH,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.ZeroX.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.ZEROX,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Bloom.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.BLOOM,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Lunyr.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.LUNYR,\n    _a[altcoin_ethereum_wallet_1.TokenConfig.Monaco.contractAddress.toLowerCase()] = altcoin_ethereum_wallet_1.TOKENS.MONACO,\n    _a);\n/**\n * Reversed map of the tokens with contract address as value\n * @returns {{}}\n * @constructor\n */\nexports.TokenMappingReverse = function () {\n    var result = {};\n    for (var prop in exports.TokenMapping) {\n        if (exports.TokenMapping.hasOwnProperty(prop)) {\n            result[exports.TokenMapping[prop]] = prop;\n        }\n    }\n    return result;\n};\nvar LightClient = /** @class */ (function () {\n    function LightClient(GCI, options, privKey, ethConfig) {\n        this.GCI = GCI;\n        this.options = options;\n        this.privKey = privKey;\n        this.ethConfig = ethConfig;\n        this.ulotion = new ulotion_1.uLotion(this.GCI, this.options);\n        if (!ethConfig) {\n            this.ethConfig = main_config_1.App.eth;\n        }\n        this.states = new Map();\n    }\n    /**\n     * Get account from private key\n     */\n    LightClient.prototype.getAccount = function () {\n        return ethereum_account_1.EthereumAccount.recoverAccount(this.privKey);\n    };\n    /**\n     * Authenticate user\n     * @param {string} privKey\n     */\n    LightClient.prototype.authenticate = function (privKey) {\n        this.privKey = privKey;\n        this.acc = ethereum_account_1.EthereumAccount.recoverAccount(privKey);\n        // const config = Object.assign({}, this.ethConfig);\n        // config.wshost = config.wshost.replace(\"wss:\", \"https:\");\n        var engine = new altcoin_ethereum_wallet_1.EthEngine(null, this.ethConfig, null);\n        this.keystore = engine.recoverAccount(this.privKey);\n        engine.login(this.keystore);\n        return engine;\n    };\n    /**\n     * Recover account and sign order\n     * @param pkey\n     * @param order\n     * @returns {any}\n     */\n    LightClient.prototype.recoverAccountAndSignOrder = function (pkey, order) {\n        var acc = ethereum_account_1.EthereumAccount.recoverAccount(pkey);\n        var signature = acc.signReceiptTendermint(order.payload.sender, order.payload.sellToken, order.payload.buyToken, order.payload.sellAmount, order.payload.buyAmount, order.payload.nonce);\n        order.payload[\"v\"] = signature.v;\n        order.payload[\"r\"] = signature.r;\n        order.payload[\"s\"] = signature.s;\n        order.payload[\"signature\"] = signature.signature;\n        order.payload[\"messageHash\"] = signature.messageHash;\n        return order;\n    };\n    /**\n     * Sign withdraw request and send to the tendermint\n     * @param pkey\n     * @param {string} token\n     * @param {number} amount\n     * @returns {WithdrawDto}\n     */\n    LightClient.prototype.recoverAccountAndSignWithdraw = function (pkey, token, amount) {\n        var acc = ethereum_account_1.EthereumAccount.recoverAccount(pkey);\n        var wdto = {};\n        var signature = acc.signWithdrawTendermint(acc.address, token, amount);\n        wdto.v = signature.v;\n        wdto.r = signature.r;\n        wdto.s = signature.s;\n        wdto.signature = signature.signature;\n        wdto.messageHash = signature.messageHash;\n        wdto.sender = acc.address;\n        wdto.token = token;\n        wdto.amount = amount.toString();\n        return wdto;\n    };\n    /**\n     * Get lastest state from node\n     * @returns {Promise<any>}\n     */\n    LightClient.prototype.refreshState = function (path) {\n        if (path === void 0) { path = ''; }\n        return __awaiter(this, void 0, void 0, function () {\n            var state, acc, balance, acc, balance;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.ulotion.state(path)];\n                    case 1:\n                        state = _a.sent();\n                        if (path === '') {\n                            state_helper_1.StateHelper.mapAddressToEnum(state, \"volume\");\n                            for (acc in state.accounts) {\n                                if (state.accounts.hasOwnProperty(acc)) {\n                                    for (balance in state.accounts[acc].balance) {\n                                        state_helper_1.StateHelper.mapAddressToEnum(state.accounts[acc], \"balance\");\n                                    }\n                                }\n                            }\n                        }\n                        else if (path === \"volume\") {\n                            state_helper_1.StateHelper.mapAddressToEnum(state);\n                        }\n                        else if (path === \"accounts\") {\n                            for (acc in state) {\n                                if (state.hasOwnProperty(acc)) {\n                                    for (balance in state[acc].balance) {\n                                        state_helper_1.StateHelper.mapAddressToEnum(state[acc], \"balance\");\n                                    }\n                                }\n                            }\n                        }\n                        if (typeof (state) === \"string\") {\n                            state = JSON.parse(state);\n                        }\n                        return [2 /*return*/, state];\n                }\n            });\n        });\n    };\n    /**\n     * Send transaction to node\n     * @param data\n     * @returns {Promise<any>}\n     */\n    LightClient.prototype.send = function (data) {\n        return __awaiter(this, void 0, void 0, function () {\n            var result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.ulotion.send(data)];\n                    case 1:\n                        result = _a.sent();\n                        return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    /**\n     * Faucet for the specific token\n     * For testnet only\n     * @param {TOKENS} token\n     * @returns {Promise<void>}\n     */\n    LightClient.prototype.faucet = function (token) {\n        return __awaiter(this, void 0, void 0, function () {\n            var eng, tokenContract;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        eng = this.authenticate(this.privKey);\n                        tokenContract = altcoin_ethereum_wallet_1.TokenFactory.GetToken(token, eng);\n                        return [4 /*yield*/, tokenContract.faucet()];\n                    case 1: \n                    // Call faucet function\n                    return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    /**\n     * Deposit token\n     * @param {TOKENS} token\n     * @param {number} amount\n     * @returns {Promise<any>}\n     */\n    LightClient.prototype.deposit = function (token, amount) {\n        return __awaiter(this, void 0, void 0, function () {\n            var eng, tokenContract, approvedResult, result, nonce;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        eng = this.authenticate(this.privKey);\n                        tokenContract = altcoin_ethereum_wallet_1.TokenFactory.GetToken(token, eng);\n                        return [4 /*yield*/, tokenContract.approve(this.ethConfig.contractAddress, amount)];\n                    case 1:\n                        approvedResult = _a.sent();\n                        return [4 /*yield*/, tokenContract.DepositToken(amount)];\n                    case 2:\n                        result = _a.sent();\n                        return [4 /*yield*/, tokenContract.currentDepositNonce()];\n                    case 3:\n                        nonce = _a.sent();\n                        return [4 /*yield*/, this.send({ action: \"deposit\", payload: { nonce: nonce } })];\n                    case 4: \n                    // Notify side chain about it\n                    return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    /**\n     * Make order\n     * @param {TOKENS} sellToken\n     * @param {TOKENS} buyToken\n     * @param {number} sellAmount\n     * @param {number} buyAmount\n     * @returns {Promise<any>}\n     */\n    LightClient.prototype.make = function (sellToken, buyToken, sellAmount, buyAmount) {\n        return __awaiter(this, void 0, void 0, function () {\n            var acc, buyTokenObj, sellTokenObj, nonceState, nonce, order, signedOrder;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        acc = this.getAccount();\n                        buyTokenObj = altcoin_ethereum_wallet_1.TokenFactory.GetToken(buyToken, null);\n                        sellTokenObj = altcoin_ethereum_wallet_1.TokenFactory.GetToken(sellToken, null);\n                        return [4 /*yield*/, this.refreshState()];\n                    case 1:\n                        nonceState = _a.sent();\n                        nonce = null;\n                        try {\n                            nonce = nonceState.nonce[sellTokenObj.contractAddress.toLowerCase()][acc.address.toLowerCase()];\n                        }\n                        catch (_b) {\n                            nonce = 1;\n                        }\n                        order = {\n                            \"action\": \"make\",\n                            \"payload\": {\n                                \"sellToken\": sellTokenObj.contractAddress,\n                                \"buyToken\": buyTokenObj.contractAddress,\n                                \"sellAmount\": sellAmount,\n                                \"buyAmount\": buyAmount,\n                                \"nonce\": nonce,\n                                \"sender\": acc.address,\n                            }\n                        };\n                        signedOrder = this.recoverAccountAndSignOrder(this.privKey, order);\n                        return [4 /*yield*/, this.send(signedOrder)];\n                    case 2: return [2 /*return*/, _a.sent()];\n                }\n            });\n        });\n    };\n    /**\n     * Get active orders for this account\n     * @returns {Promise<any>}\n     */\n    LightClient.prototype.getActiveOrders = function (all, sellToken, buyToken) {\n        if (all === void 0) { all = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var acc, address, result, path;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        acc = this.getAccount();\n                        address = acc.address.toLowerCase();\n                        result = null;\n                        path = \"orders['\" + address + \"']\";\n                        if (all && (sellToken || buyToken)) {\n                            path = \"$..orders..\";\n                        }\n                        else if (all) {\n                            path = \"$..orders\";\n                        }\n                        if (!(!sellToken && !buyToken)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.refreshState(path)];\n                    case 1:\n                        result = _a.sent();\n                        if (result && result.length > 0) {\n                            result = result[0];\n                        }\n                        return [3 /*break*/, 8];\n                    case 2:\n                        if (!(buyToken && sellToken)) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.refreshState(path + \"[?(@.buyToken=='\" + exports.TokenMappingReverse()[buyToken] + \"' %26%26 @.sellToken=='\" + exports.TokenMappingReverse()[sellToken] + \"')]\")];\n                    case 3:\n                        // OMG Need to escape this at raw format O.o\n                        result = _a.sent();\n                        return [3 /*break*/, 8];\n                    case 4:\n                        if (!sellToken) return [3 /*break*/, 6];\n                        return [4 /*yield*/, this.refreshState(path + \"[?(@.sellToken=='\" + exports.TokenMappingReverse()[sellToken] + \"')]\")];\n                    case 5:\n                        result = _a.sent();\n                        return [3 /*break*/, 8];\n                    case 6:\n                        if (!buyToken) return [3 /*break*/, 8];\n                        return [4 /*yield*/, this.refreshState(path + \"[?(@.buyToken=='\" + exports.TokenMappingReverse()[buyToken] + \"')]\")];\n                    case 7:\n                        result = _a.sent();\n                        _a.label = 8;\n                    case 8: return [2 /*return*/, result];\n                }\n            });\n        });\n    };\n    /**\n     * Withdraw token\n     * @param {TOKENS} withdrawToken\n     * @param amount\n     * @param useLatestState use latest state insead of the sending new one on the blockchain\n     * This is used if there is case when withdraw from blockchain is failed due to the gas limit therefore\n     * last signed transaction is repeated on the main chain\n     * @returns {Promise<void>}\n     */\n    LightClient.prototype.withdraw = function (withdrawToken, amount, useLatestState) {\n        if (useLatestState === void 0) { useLatestState = false; }\n        return __awaiter(this, void 0, void 0, function () {\n            var eng, tokenContract, withdrawRequest, wConf, wRes, withdrawConfirmation;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        eng = this.authenticate(this.privKey);\n                        tokenContract = altcoin_ethereum_wallet_1.TokenFactory.GetToken(withdrawToken, eng);\n                        withdrawRequest = this.recoverAccountAndSignWithdraw(this.privKey, tokenContract.contractAddress, amount);\n                        if (!!useLatestState) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.send({ action: \"withdraw\", payload: withdrawRequest })];\n                    case 1:\n                        wConf = _a.sent();\n                        _a.label = 2;\n                    case 2: return [4 /*yield*/, this.refreshState(\"accounts['\" + this.acc.address.toLowerCase() + \"'].lastSignedWithdraw\")];\n                    case 3:\n                        wRes = _a.sent();\n                        if (wRes && wRes.length > 0) {\n                            wRes = wRes[0];\n                        }\n                        return [4 /*yield*/, tokenContract.withdraw(wRes.sender, wRes.amount, wRes.nonce, wRes.v, wRes.r, wRes.s)];\n                    case 4:\n                        withdrawConfirmation = _a.sent();\n                        eng = null;\n                        console.log(\"Confirmation\", withdrawConfirmation);\n                        return [2 /*return*/, withdrawConfirmation];\n                }\n            });\n        });\n    };\n    /**\n     * Subscribe at the event\n     * @param {string} path\n     * @param func\n     * @returns {Promise<() => Promise<any>>}\n     */\n    LightClient.prototype.subscribe = function (path, func) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.subscribeMulti([path], func)];\n            });\n        });\n    };\n    /**\n     * Subscribe at the multiple events\n     * @param {string} path\n     * @param func\n     * @returns {Promise<() => Promise<any>>}\n     */\n    LightClient.prototype.subscribeMulti = function (path, func) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _i, path_1, i, state, stateWatcher, that, evtHandler, evt;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _i = 0, path_1 = path;\n                        _a.label = 1;\n                    case 1:\n                        if (!(_i < path_1.length)) return [3 /*break*/, 4];\n                        i = path_1[_i];\n                        return [4 /*yield*/, this.refreshState(i)];\n                    case 2:\n                        state = _a.sent();\n                        stateWatcher = new state_merge_patch_1.StateMergePatch(state, i);\n                        this.states.set(i, stateWatcher);\n                        _a.label = 3;\n                    case 3:\n                        _i++;\n                        return [3 /*break*/, 1];\n                    case 4:\n                        that = this;\n                        evtHandler = function () { return __awaiter(_this, void 0, void 0, function () {\n                            var _this = this;\n                            return __generator(this, function (_a) {\n                                that.states.forEach(function (value, key) { return __awaiter(_this, void 0, void 0, function () {\n                                    var result;\n                                    return __generator(this, function (_a) {\n                                        switch (_a.label) {\n                                            case 0: return [4 /*yield*/, value.diff(that)];\n                                            case 1:\n                                                result = _a.sent();\n                                                func(key, result);\n                                                return [2 /*return*/];\n                                        }\n                                    });\n                                }); });\n                                return [2 /*return*/];\n                            });\n                        }); };\n                        return [4 /*yield*/, this.ulotion.subscribeTx(evtHandler)];\n                    case 5:\n                        evt = _a.sent();\n                        return [2 /*return*/, evtHandler];\n                }\n            });\n        });\n    };\n    return LightClient;\n}());\nexports.LightClient = LightClient;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"altcoin-ethereum-wallet\");\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Account = __webpack_require__(3);\nvar Hash = __webpack_require__(4);\nvar Web3Utils = __webpack_require__(5);\nvar HDKey = __webpack_require__(6);\nvar EthereumAccount = /** @class */ (function () {\n    function EthereumAccount(account) {\n        this.account = account;\n    }\n    Object.defineProperty(EthereumAccount.prototype, \"privateKey\", {\n        get: function () {\n            return this.account.privateKey;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EthereumAccount.prototype, \"address\", {\n        get: function () {\n            return this.account.address;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Recover account from seed\n     * @param {string} seed\n     * @returns {EthereumAccount}\n     */\n    EthereumAccount.recoverAccountFromSeed = function (seed) {\n        var hdkey = new HDKey.fromMasterSeed(seed);\n        var hdnode = hdkey.derive(\"m/44'/60'/0'/0/0\");\n        var privateKey = hdnode._privateKey.toString(\"hex\");\n        var accounts = Account.accounts;\n        var acc = accounts.privateKeyToAccount(\"0x\" + privateKey);\n        return acc;\n    };\n    /**\n     * Recover account from private key\n     * @param {string} pk\n     * @returns {EthereumAccount}\n     */\n    EthereumAccount.recoverAccount = function (pk) {\n        return new EthereumAccount(Account.fromPrivate(\"0x\" + pk));\n    };\n    /**\n     * Sign receipt\n     * @param sender\n     * @param sellToken\n     * @param buyToken\n     * @param sellAmount\n     * @param buyAmount\n     * @param nonce\n     * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n     */\n    EthereumAccount.prototype.signReceiptTendermint = function (sender, sellToken, buyToken, sellAmount, buyAmount, nonce) {\n        var data = sender + sellToken + buyToken + this.hexValue(sellAmount) + this.hexValue(buyAmount) + this.hexValue(nonce);\n        var hash = this.hashMessage(data);\n        return this.signHash(data, hash);\n    };\n    /**\n     * Sign withdraw\n     * @param sender\n     * @param token\n     * @param amount\n     * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n     */\n    EthereumAccount.prototype.signWithdrawTendermint = function (sender, token, amount) {\n        var data = sender + token + this.hexValue(amount);\n        var hash = this.hashMessage(data);\n        return this.signHash(data, hash);\n    };\n    /**\n     * Sign receipt by parameters\n     * @param contractAddress\n     * @param value\n     * @param ticketNumber\n     * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n     */\n    EthereumAccount.prototype.signReceipt = function (contractAddress, value, ticketNumber) {\n        if (typeof value !== \"string\") {\n            throw new Error(\"value must be string\");\n        }\n        var data = contractAddress + this.hexValue(value) + this.hexValue(ticketNumber);\n        return this.sign(data);\n    };\n    /**\n     * To hex\n     * @param val\n     * @returns {string}\n     */\n    EthereumAccount.prototype.hexValue = function (val) {\n        return Web3Utils.asciiToHex(val).replace(\"0x\", \"\");\n    };\n    /**\n     * Sign hash\n     * @param data\n     * @param hash\n     * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n     */\n    EthereumAccount.prototype.signHash = function (data, hash) {\n        var signature = Account.sign(hash, this.privateKey);\n        var vrs = Account.decodeSignature(signature);\n        return {\n            message: data,\n            messageHash: hash,\n            v: vrs[0],\n            r: vrs[1],\n            s: vrs[2],\n            signature: signature\n        };\n    };\n    ;\n    /**\n     * Sign data\n     * @param data\n     * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n     */\n    EthereumAccount.prototype.sign = function (data) {\n        var hash = this.hashMessage(data);\n        var signature = Account.sign(hash, this.privateKey);\n        var vrs = Account.decodeSignature(signature);\n        return {\n            message: data,\n            messageHash: hash,\n            v: vrs[0],\n            r: vrs[1],\n            s: vrs[2],\n            signature: signature\n        };\n    };\n    ;\n    /**\n     * Hash message\n     * @param {string} data\n     * @returns {any}\n     */\n    EthereumAccount.prototype.hashMessage = function (data) {\n        return Hash.keccak256s(data);\n    };\n    ;\n    return EthereumAccount;\n}());\nexports.EthereumAccount = EthereumAccount;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"eth-lib/lib/account\");\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"eth-lib/lib/hash\");\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"web3-utils\");\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"hdkey\");\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ulotion_helper_1 = __webpack_require__(8);\nvar axios = __webpack_require__(15);\nvar tendermint = __webpack_require__(16);\nvar uLotion = /** @class */ (function () {\n    function uLotion(GCI, options) {\n        this.GCI = GCI;\n        this.options = options;\n        this.nodes = [];\n        this.nodes = options.nodes;\n        if (!GCI) {\n            if (this.nodes === undefined || this.nodes.length === 0) {\n                throw Error('Nodes not set');\n            }\n        }\n    }\n    /**\n     * Get genesis active peer\n     * @returns {Promise<string>}\n     */\n    uLotion.prototype.getGenesisActivePeer = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var rpcAddr, genesis;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.GCI) return [3 /*break*/, 2];\n                        return [4 /*yield*/, ulotion_helper_1.ulotionHelper.fetchGenesis(this.GCI)];\n                    case 1:\n                        genesis = _a.sent();\n                        rpcAddr = \"http://\" + genesis.peer.host + \":\" + this.options.tendermintPort;\n                        return [3 /*break*/, 3];\n                    case 2:\n                        rpcAddr = this.nodes[0]; //.replace('http:', 'ws:');\n                        _a.label = 3;\n                    case 3: return [2 /*return*/, rpcAddr];\n                }\n            });\n        });\n    };\n    /**\n     * Get state from tendermint client\n     * @param {string} path\n     * @returns {Promise<any>}\n     */\n    uLotion.prototype.state = function (path) {\n        if (path === void 0) { path = ''; }\n        return __awaiter(this, void 0, void 0, function () {\n            var rpcAddr, queryResponse, resp, value;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getGenesisActivePeer()];\n                    case 1:\n                        rpcAddr = _a.sent();\n                        return [4 /*yield*/, axios.get(rpcAddr + \"/abci_query?path=\\\"\" + path + \"\\\"\")];\n                    case 2:\n                        queryResponse = _a.sent();\n                        if (queryResponse.data.error && !queryResponse.data.result) {\n                            throw new Error(JSON.stringify(queryResponse.data.error));\n                        }\n                        resp = queryResponse.data.result.response;\n                        resp.height = Number(resp.height);\n                        value = null;\n                        try {\n                            value = JSON.parse(Buffer.from(resp.value, 'base64').toString());\n                        }\n                        catch (e) {\n                            throw new Error('invalid json in query response');\n                        }\n                        return [2 /*return*/, value];\n                }\n            });\n        });\n    };\n    /**\n     * Send transaction\n     * @param tx\n     * @returns {Promise<any>}\n     */\n    uLotion.prototype.send = function (tx) {\n        return __awaiter(this, void 0, void 0, function () {\n            var rpcAddr, txBytes, result;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getGenesisActivePeer()];\n                    case 1:\n                        rpcAddr = _a.sent();\n                        txBytes = '0x' + Buffer.from(JSON.stringify(tx)).toString('hex');\n                        return [4 /*yield*/, axios.get(rpcAddr.replace('ws:', 'http:') + \"/broadcast_tx_commit\", {\n                                params: {\n                                    tx: txBytes\n                                }\n                            })];\n                    case 2:\n                        result = _a.sent();\n                        return [2 /*return*/, result.data.result];\n                }\n            });\n        });\n    };\n    /**\n     * Subscribe to transaction event\n     * @param func\n     * @returns {Promise<void>}\n     */\n    uLotion.prototype.subscribeTx = function (func) {\n        return __awaiter(this, void 0, void 0, function () {\n            var rpcAddr, rpc;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.getGenesisActivePeer()];\n                    case 1:\n                        rpcAddr = (_a.sent())\n                            .replace('http:', 'ws:')\n                            .replace('https:', 'wss:');\n                        console.log(rpcAddr);\n                        rpc = tendermint.RpcClient(rpcAddr);\n                        this.eventRpc = rpc;\n                        rpc.on('close', function (e) {\n                            console.log(e);\n                        });\n                        // console.log(rpc);\n                        rpc.on('error', function (e) {\n                            console.log('RPC Error: ', e);\n                        });\n                        rpc.subscribe({ query: \"tm.event='Tx'\" }, func);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return uLotion;\n}());\nexports.uLotion = uLotion;\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar crypto_browserify_1 = __webpack_require__(9);\nvar stableStringify = __webpack_require__(10);\n// const IPFS = require('ipfs');\n// const OrbitDB = require('orbit-db');\n// const discoveryChannel = require('discovery-channel');\n// const net = require('net');\n// const defaults = require('dat-swarm-defaults')();\nvar signalhub = __webpack_require__(11);\nvar swarm = __webpack_require__(12);\nvar vstruct = __webpack_require__(13);\nvar TxStruct = vstruct([\n    { name: 'data', type: vstruct.VarString(vstruct.UInt32BE) },\n    { name: 'nonce', type: vstruct.UInt32BE },\n]);\nvar base64Prefix = ':base64:';\nvar ulotionHelper = /** @class */ (function () {\n    function ulotionHelper() {\n    }\n    ulotionHelper.convertBase64ToBuffers = function (obj) {\n        return ulotionHelper.replace(obj, ulotionHelper.bufferToBase64Replacer);\n    };\n    ulotionHelper.base64ToBufferReplacer = function (value) {\n        if (typeof value !== 'string')\n            return value;\n        if (!value.startsWith(base64Prefix))\n            return value;\n        return Buffer.from(value.slice(base64Prefix.length), 'base64');\n    };\n    /**\n     * Encode transaction\n     * @param txData\n     * @param nonce\n     * @returns {any}\n     */\n    ulotionHelper.encode = function (txData, nonce) {\n        var data = ulotionHelper.stringify(txData);\n        var bytes = TxStruct.encode({ nonce: nonce, data: data });\n        return bytes;\n    };\n    ulotionHelper.fetchGenesis = function (GCI) {\n        return new Promise(function (resolve, reject) {\n            var hub = signalhub(GCI, ['https://signalhub.altcoin.io']);\n            var sw;\n            // Check for environment\n            if (typeof process === 'object' && process + '' === '[object process]') {\n                sw = swarm(hub, { wrtc: __webpack_require__(14) });\n            }\n            else {\n                sw = swarm(hub, {});\n            }\n            sw.on('peer', function (peer, id) {\n                peer.on('data', function (data) {\n                    // full node writing to tell me what port to use for their tendermint rpc server\n                    var port = Number(data.toString());\n                    if (port > 100 && port < 65536) {\n                        peer.destroy();\n                        resolve({ peer: { host: peer.remoteAddress, port: port } });\n                    }\n                });\n            });\n        });\n    };\n    /**\n     * Get hash of the object\n     * @param obj\n     * @returns {any}\n     */\n    ulotionHelper.hash = function (obj) {\n        var hash = crypto_browserify_1.createHash('sha256');\n        var result = ulotionHelper.stringify(obj);\n        return hash.update(result, 'utf8').digest().toString('hex');\n    };\n    /**\n     * Parse string\n     * @param json\n     */\n    ulotionHelper.parse = function (json) {\n        var obj = JSON.parse(json);\n        return ulotionHelper.convertBase64ToBuffers(obj);\n    };\n    /**\n     * Get hash data from genesis\n     * @param genesis\n     */\n    ulotionHelper.getGCIFromGenesis = function (genesis) {\n        var hash = crypto_browserify_1.createHash('sha256');\n        // TODO: Check for genesisTime if needs to be hashed to get correct GCI\n        var genesisJson = ulotionHelper.parse(genesis);\n        genesisJson.genesis_time = \"\";\n        var genesisStr = ulotionHelper.stringify(genesisJson);\n        return hash.update(genesisStr, 'utf8').digest().toString('hex');\n    };\n    /**\n     * Clones an object\n     * @param obj\n     * @param replacer\n     * @returns {{}}\n     */\n    ulotionHelper.deepClone = function (obj, replacer) {\n        var newObj = Array.isArray(obj) ? [] : {};\n        Object.assign(newObj, obj);\n        for (var key in newObj) {\n            newObj[key] = replacer(newObj[key]);\n            if (typeof newObj[key] === 'object') {\n                newObj[key] = this.deepClone(newObj[key], replacer);\n            }\n        }\n        return newObj;\n    };\n    /**\n     * Replaces values in an object without cloning\n     * @param obj\n     * @param replacer\n     * @returns {any}\n     */\n    ulotionHelper.replace = function (obj, replacer) {\n        for (var key in obj) {\n            obj[key] = replacer(obj[key]);\n            if (typeof obj[key] === 'object' && !Buffer.isBuffer(obj[key])) {\n                // recursively replace props of objects (unless it's a Buffer)\n                ulotionHelper.replace(obj[key], replacer);\n            }\n        }\n        return obj;\n    };\n    /**\n     * Stringify obj\n     * @param obj\n     * @returns {any}\n     */\n    ulotionHelper.stringify = function (obj) {\n        var convertedObj = ulotionHelper.deepClone(obj, ulotionHelper.bufferToBase64Replacer);\n        return stableStringify(convertedObj);\n    };\n    /**\n     * Replace buffer to base64\n     * @param value\n     * @returns {any}\n     */\n    ulotionHelper.bufferToBase64Replacer = function (value) {\n        if (typeof value === 'object' &&\n            value != null &&\n            value.type === 'Buffer' &&\n            Array.isArray(value.data)) {\n            value = Buffer.from(value);\n        }\n        if (!Buffer.isBuffer(value))\n            return value;\n        return \"\" + base64Prefix + value.toString('base64');\n    };\n    return ulotionHelper;\n}());\nexports.ulotionHelper = ulotionHelper;\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"crypto-browserify\");\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"json-stable-stringify\");\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"signalhub\");\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"webrtc-swarm\");\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"varstruct\");\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"wrtc\");\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"axios\");\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"tendermint\");\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.App = {\n    eth: {\n        wshost: \"wss://geth.altcoin.io\",\n        contractAddress: \"0xCe11e94E26D6fcB837F3E8a61C7c2e03523f4958\",\n        defaultWallet: \"0xb483f5a8c6ebA74Dc1bcef9D167E6B86Caa4C773\",\n    }\n};\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar main_1 = __webpack_require__(0);\nvar StateHelper = /** @class */ (function () {\n    function StateHelper() {\n    }\n    /**\n     * Map address to enum\n     * @param obj\n     * @param prop\n     */\n    StateHelper.mapAddressToEnum = function (obj, prop) {\n        if (prop) {\n            for (var i in obj[prop]) {\n                if (obj[prop].hasOwnProperty(i)) {\n                    obj[prop][main_1.TokenMapping[i.toLowerCase()]] = obj[prop][i];\n                    delete obj[prop][i];\n                }\n            }\n        }\n        else {\n            for (var arr in obj) {\n                if (obj.hasOwnProperty(arr)) {\n                    for (var i in obj[arr]) {\n                        if (obj[arr].hasOwnProperty(i)) {\n                            obj[arr][main_1.TokenMapping[i.toLowerCase()]] = obj[arr][i];\n                            delete obj[arr][i];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    return StateHelper;\n}());\nexports.StateHelper = StateHelper;\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar jsondiffpatch_1 = __webpack_require__(20);\nvar StateMergePatch = /** @class */ (function () {\n    function StateMergePatch(state, path) {\n        this.path = path;\n        this.dp = new jsondiffpatch_1.DiffPatcher();\n        this.state = this.dp.clone(state);\n    }\n    /**\n     * Diff two states\n     * @param {LightClient} lc\n     * @returns {Promise<any>}\n     */\n    StateMergePatch.prototype.diff = function (lc) {\n        return __awaiter(this, void 0, void 0, function () {\n            var newState, currentState;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, lc.refreshState(this.path)];\n                    case 1:\n                        newState = _a.sent();\n                        currentState = this.dp.diff(this.state, newState);\n                        this.state = newState;\n                        return [2 /*return*/, StateMergePatch.patchToMergePatch(currentState)];\n                }\n            });\n        });\n    };\n    /**\n     * Check if key is numeric\n     * @param n\n     * @returns {boolean}\n     */\n    StateMergePatch.isNumeric = function (n) {\n        if (n.toLowerCase().startsWith(\"0x\")) {\n            return false;\n        }\n        return !isNaN(parseFloat(n)) && isFinite(n);\n    };\n    /**\n     * Check if it has child array\n     * @param obj\n     * @returns {boolean}\n     */\n    StateMergePatch.isChildArray = function (obj) {\n        for (var i in obj) {\n            return StateMergePatch.isNumeric(i);\n        }\n    };\n    /**\n     * Create new object\n     * @param obj\n     * @returns {{}}\n     */\n    StateMergePatch.toObjType = function (obj) {\n        return StateMergePatch.isChildArray(obj) ? [] : {};\n    };\n    /**\n     * Handle array value\n     * @param val\n     * @returns {any}\n     */\n    StateMergePatch.handleValue = function (val) {\n        if (Array.isArray(val)) {\n            if (val.length > 1) {\n                return val[1];\n            }\n            return val[0];\n        }\n    };\n    /**\n     * Handle object\n     * @param key\n     * @param value\n     * @param result\n     */\n    StateMergePatch.handleObj = function (key, value, result) {\n        if (Array.isArray(value)) {\n            result[key] = StateMergePatch.handleValue(value);\n            return;\n        }\n        var obj = StateMergePatch.toObjType(value);\n        if (Array.isArray(result)) {\n            result.push(obj);\n        }\n        else {\n            result[key] = obj;\n        }\n        StateMergePatch.patchToMergePatch(value, obj);\n    };\n    /**\n     * Convert patch to merge patch\n     * TODO: Refactor\n     * @param patch\n     * @param result\n     * @returns {any}\n     */\n    StateMergePatch.patchToMergePatch = function (patch, result) {\n        for (var i in patch) {\n            // Is array\n            if (StateMergePatch.isNumeric(i)) {\n                if (result === undefined) {\n                    result = [];\n                }\n                if (typeof patch[i] === \"string\") {\n                    result.push(patch[i]);\n                }\n                else if (typeof patch[i] == \"object\") {\n                    this.handleObj(i, patch[i], result);\n                }\n                else if (Array.isArray(patch[i])) {\n                    result.push(StateMergePatch.handleValue(patch[i]));\n                }\n            }\n            else {\n                if (result === undefined) {\n                    result = StateMergePatch.toObjType(patch[i]);\n                }\n                if (typeof patch[i] === \"string\") {\n                    result[i] = patch[i];\n                }\n                else if (typeof patch[i] == \"object\") {\n                    this.handleObj(i, patch[i], result);\n                }\n                else if (Array.isArray(patch[i])) {\n                    result[i] = StateMergePatch.handleValue(patch[i]);\n                }\n            }\n        }\n        return result;\n    };\n    return StateMergePatch;\n}());\nexports.StateMergePatch = StateMergePatch;\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\nmodule.exports = require(\"jsondiffpatch\");\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// dist/index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 21fd1e9f1fbd8a7d8bd5","import {DepositDto} from \"./dto/deposit.dto\";\nimport {WithdrawDto} from \"./dto/withdraw.dto\";\nimport {OrderDto} from \"./dto/order.dto\";\nimport {EthereumAccount} from \"./eth/ethereum-account\";\nimport {uLotion} from \"./services/ulotion\";\nimport {EthEngine, TokenConfig, TokenFactory, TOKENS} from \"altcoin-ethereum-wallet\";\nimport {App} from \"./config/main.config\";\nimport {AugurTokenTestnet} from \"altcoin-ethereum-wallet/dist/src/eth-tokens/augur\";\nimport {IBlockchainState} from \"./interfaces\";\nimport {StateHelper} from \"./common/state-helper\";\nimport {StateMergePatch} from \"./common/state-merge-patch\";\n\n// Export wallet\nexport {\n  TOKENS,\n  TokenFactory,\n  ERC20,\n  EthEngine,\n  EthereumWallet,\n  TokenConfig,\n  TokenConfigMain,\n  generateMnemonic,\n  AugurTokenTestnet,\n  AugurTokenMainnet} from \"altcoin-ethereum-wallet\";\n\n// TODO: Add dynamic tokens for easier adding new ones later\nexport const TokenMapping = {\n  [TokenConfig.Augur.contractAddress.toLowerCase()]: TOKENS.AUGUR,\n  [TokenConfig.Golem.contractAddress.toLowerCase()]: TOKENS.GOLEM,\n  [TokenConfig.Gnosis.contractAddress.toLowerCase()]: TOKENS.GNOSIS,\n  [TokenConfig.Bat.contractAddress.toLowerCase()]: TOKENS.BAT,\n  [TokenConfig.Aragon.contractAddress.toLowerCase()]: TOKENS.ARAGON,\n  [TokenConfig.Eos.contractAddress.toLowerCase()]: TOKENS.EOS,\n  [TokenConfig.Salt.contractAddress.toLowerCase()]: TOKENS.SALT,\n  [TokenConfig.Civic.contractAddress.toLowerCase()]: TOKENS.CIVIC,\n  [TokenConfig.OmiseGo.contractAddress.toLowerCase()]: TOKENS.OMISEGO,\n  [TokenConfig.District0x.contractAddress.toLowerCase()]: TOKENS.DISTRICT0X,\n  [TokenConfig.StatusNetwork.contractAddress.toLowerCase()]: TOKENS.STATUSNETWORK,\n  [TokenConfig.Substratum.contractAddress.toLowerCase()]: TOKENS.SUBSTRATUM,\n  [TokenConfig.Tron.contractAddress.toLowerCase()]: TOKENS.TRON,\n  [TokenConfig.Bytom.contractAddress.toLowerCase()]: TOKENS.BYTOM,\n  [TokenConfig.Dent.contractAddress.toLowerCase()]: TOKENS.DENT,\n  [TokenConfig.Populous.contractAddress.toLowerCase()]: TOKENS.POPULOUS,\n  [TokenConfig.Maker.contractAddress.toLowerCase()]: TOKENS.MAKER,\n  [TokenConfig.DigixDAO.contractAddress.toLowerCase()]: TOKENS.DIGIXDAO,\n  [TokenConfig.QASH.contractAddress.toLowerCase()]: TOKENS.QASH,\n  [TokenConfig.Ethos.contractAddress.toLowerCase()]: TOKENS.ETHOS,\n  [TokenConfig.FunFair.contractAddress.toLowerCase()]: TOKENS.FUNFAIR,\n  [TokenConfig.RequestNetwork.contractAddress.toLowerCase()]: TOKENS.REQUESTNETWORK,\n  [TokenConfig.Bancor.contractAddress.toLowerCase()]: TOKENS.BANCOR,\n  [TokenConfig.Iconomi.contractAddress.toLowerCase()]: TOKENS.ICONOMI,\n  [TokenConfig.TenXPay.contractAddress.toLowerCase()]: TOKENS.TENXPAY,\n  [TokenConfig.Storj.contractAddress.toLowerCase()]: TOKENS.STORJ,\n  [TokenConfig.EnjinCoin.contractAddress.toLowerCase()]: TOKENS.ENJINCOIN,\n  [TokenConfig.WETH.contractAddress.toLowerCase()]: TOKENS.WETH,\n  [TokenConfig.ZeroX.contractAddress.toLowerCase()]: TOKENS.ZEROX,\n  [TokenConfig.Bloom.contractAddress.toLowerCase()]: TOKENS.BLOOM,\n  [TokenConfig.Lunyr.contractAddress.toLowerCase()]: TOKENS.LUNYR,\n  [TokenConfig.Monaco.contractAddress.toLowerCase()]: TOKENS.MONACO,\n};\n\n/**\n * Reversed map of the tokens with contract address as value\n * @returns {{}}\n * @constructor\n */\nexport const TokenMappingReverse = () => {\n  const result = {};\n\n  for (let prop in TokenMapping) {\n    if(TokenMapping.hasOwnProperty(prop)) {\n      result[TokenMapping[prop]] = prop;\n    }\n  }\n\n  return result;\n};\n\nexport class LightClient {\n\n  private state: any;\n  private states: Map<string, StateMergePatch>;\n  private acc: EthereumAccount;\n  // private eng: EthEngine; : TODO: Fix ws reconnect\n  private ulotion: uLotion;\n  private keystore: any;\n  public static state: any;\n  public stateWatcher: StateMergePatch;\n  public eventFeed;\n\n  constructor(private GCI: string, private options, private privKey, private ethConfig?) {\n    this.ulotion = new uLotion(this.GCI, this.options);\n    if (!ethConfig) {\n      this.ethConfig = App.eth;\n    }\n    this.states = new Map<string, StateMergePatch>();\n  }\n\n  /**\n   * Get account from private key\n   */\n  private getAccount() {\n    return EthereumAccount.recoverAccount(this.privKey);\n  }\n\n  /**\n   * Authenticate user\n   * @param {string} privKey\n   */\n  public authenticate(privKey: string) {\n    this.privKey = privKey;\n    this.acc = EthereumAccount.recoverAccount(privKey);\n    // const config = Object.assign({}, this.ethConfig);\n    // config.wshost = config.wshost.replace(\"wss:\", \"https:\");\n    const engine = new EthEngine(null, this.ethConfig, null);\n    this.keystore = engine.recoverAccount(this.privKey);\n    engine.login(this.keystore);\n    return engine;\n  }\n\n  /**\n   * Recover account and sign order\n   * @param pkey\n   * @param order\n   * @returns {any}\n   */\n  public recoverAccountAndSignOrder(pkey, order) {\n    let acc = EthereumAccount.recoverAccount(pkey);\n    const signature = acc.signReceiptTendermint(order.payload.sender,\n      order.payload.sellToken,\n      order.payload.buyToken,\n      order.payload.sellAmount, order.payload.buyAmount, order.payload.nonce);\n\n    order.payload[\"v\"] = signature.v;\n    order.payload[\"r\"] = signature.r;\n    order.payload[\"s\"] = signature.s;\n    order.payload[\"signature\"] = signature.signature;\n    order.payload[\"messageHash\"] = signature.messageHash;\n\n    return order;\n  }\n\n  /**\n   * Sign withdraw request and send to the tendermint\n   * @param pkey\n   * @param {string} token\n   * @param {number} amount\n   * @returns {WithdrawDto}\n   */\n  public recoverAccountAndSignWithdraw(pkey, token: string, amount: number): WithdrawDto {\n    let acc = EthereumAccount.recoverAccount(pkey);\n    const wdto = {} as WithdrawDto;\n\n    const signature = acc.signWithdrawTendermint(acc.address,\n      token,\n      amount);\n\n    wdto.v = signature.v;\n    wdto.r = signature.r;\n    wdto.s = signature.s;\n    wdto.signature = signature.signature;\n    wdto.messageHash = signature.messageHash;\n    wdto.sender = acc.address;\n    wdto.token = token;\n    wdto.amount = amount.toString();\n\n    return wdto;\n  }\n\n  /**\n   * Get lastest state from node\n   * @returns {Promise<any>}\n   */\n  public async refreshState(path: string = ''): Promise<any> {\n    let state = await this.ulotion.state(path) as IBlockchainState;\n\n    if (path === '') {\n      StateHelper.mapAddressToEnum(state, \"volume\");\n      for (const acc in state.accounts) {\n        if (state.accounts.hasOwnProperty(acc)) {\n          for (const balance in state.accounts[acc].balance) {\n            StateHelper.mapAddressToEnum(state.accounts[acc], \"balance\");\n          }\n        }\n      }\n    } else if (path === \"volume\") {\n      StateHelper.mapAddressToEnum(state);\n    } else if (path === \"accounts\") {\n      for (const acc in state) {\n        if (state.hasOwnProperty(acc)) {\n          for (const balance in state[acc].balance) {\n            StateHelper.mapAddressToEnum(state[acc], \"balance\");\n          }\n        }\n      }\n    }\n\n    if (typeof(state) === \"string\") {\n      state = JSON.parse(state);\n    }\n\n    return state;\n  }\n\n  /**\n   * Send transaction to node\n   * @param data\n   * @returns {Promise<any>}\n   */\n  private async send(data: any) {\n    const result = await this.ulotion.send(data);\n    return result;\n  }\n\n  /**\n   * Faucet for the specific token\n   * For testnet only\n   * @param {TOKENS} token\n   * @returns {Promise<void>}\n   */\n  public async faucet(token: TOKENS) {\n\n    const eng = this.authenticate(this.privKey);\n\n    // Get token\n    const tokenContract = TokenFactory.GetToken(token, eng);\n\n    // Call faucet function\n    return await tokenContract.faucet();\n  }\n\n  /**\n   * Deposit token\n   * @param {TOKENS} token\n   * @param {number} amount\n   * @returns {Promise<any>}\n   */\n  public async deposit(token: TOKENS, amount: number) {\n\n    const eng = this.authenticate(this.privKey);\n\n    // Get token\n    const tokenContract = TokenFactory.GetToken(token, eng);\n\n    // Approve token for spender\n    const approvedResult = await tokenContract.approve(this.ethConfig.contractAddress, amount);\n\n    // Deposit token to contract\n    const result = await tokenContract.DepositToken(amount);\n\n    // Deposit token to contract\n    const nonce = await tokenContract.currentDepositNonce();\n\n    // Notify side chain about it\n    return await this.send({ action: \"deposit\", payload: {nonce: nonce} });\n  }\n\n  /**\n   * Make order\n   * @param {TOKENS} sellToken\n   * @param {TOKENS} buyToken\n   * @param {number} sellAmount\n   * @param {number} buyAmount\n   * @returns {Promise<any>}\n   */\n  public async make(sellToken: TOKENS, buyToken: TOKENS, sellAmount: number, buyAmount: number) {\n\n    const acc = this.getAccount();\n\n    // Get token\n    const buyTokenObj = TokenFactory.GetToken(buyToken, null);\n    const sellTokenObj = TokenFactory.GetToken(sellToken, null);\n\n    const nonceState = await this.refreshState();\n    let nonce = null;\n    try {\n      nonce = nonceState.nonce[sellTokenObj.contractAddress.toLowerCase()][acc.address.toLowerCase()];\n    } catch {\n      nonce = 1;\n    }\n\n    const order = {\n      \"action\" : \"make\",\n      \"payload\" : {\n        \"sellToken\": sellTokenObj.contractAddress,\n        \"buyToken\": buyTokenObj.contractAddress,\n        \"sellAmount\": sellAmount,\n        \"buyAmount\": buyAmount,\n        \"nonce\": nonce,\n        \"sender\": acc.address,\n      }};\n\n    const signedOrder = this.recoverAccountAndSignOrder(this.privKey, order);\n\n    return await this.send(signedOrder);\n  }\n\n  /**\n   * Get active orders for this account\n   * @returns {Promise<any>}\n   */\n  public async getActiveOrders(all: boolean = false, sellToken?: TOKENS, buyToken?: TOKENS) {\n    const acc = this.getAccount();\n    const address = acc.address.toLowerCase();\n    let result = null;\n    let path = `orders['${address}']`;\n\n    if (all && (sellToken || buyToken)) {\n      path = \"$..orders..\";\n    } else if (all) {\n      path = \"$..orders\"\n    }\n\n    if (!sellToken && !buyToken) {\n      result = await this.refreshState(path);\n      if (result && result.length > 0) {\n        result = result[0];\n      }\n    } else if (buyToken && sellToken) {\n      // OMG Need to escape this at raw format O.o\n      result = await this.refreshState(`${path}[?(@.buyToken=='${TokenMappingReverse()[buyToken]}' %26%26 @.sellToken=='${TokenMappingReverse()[sellToken]}')]`);\n    } else if (sellToken) {\n      result = await this.refreshState(`${path}[?(@.sellToken=='${TokenMappingReverse()[sellToken]}')]`);\n    } else if (buyToken) {\n      result = await this.refreshState(`${path}[?(@.buyToken=='${TokenMappingReverse()[buyToken]}')]`);\n    }\n\n    return result;\n  }\n\n  /**\n   * Withdraw token\n   * @param {TOKENS} withdrawToken\n   * @param amount\n   * @param useLatestState use latest state insead of the sending new one on the blockchain\n   * This is used if there is case when withdraw from blockchain is failed due to the gas limit therefore\n   * last signed transaction is repeated on the main chain\n   * @returns {Promise<void>}\n   */\n  public async withdraw(withdrawToken: TOKENS, amount: number, useLatestState: boolean = false) {\n\n    let eng = this.authenticate(this.privKey);\n\n    // Get token\n    const tokenContract = TokenFactory.GetToken(withdrawToken, eng);\n    const withdrawRequest = this.recoverAccountAndSignWithdraw(this.privKey, tokenContract.contractAddress, amount);\n\n    // Notify side chain about it\n    if (!useLatestState) {\n      const wConf = await this.send({action: \"withdraw\", payload: withdrawRequest});\n    }\n\n    // Get state from blockchain\n    let wRes = await this.refreshState(`accounts['${this.acc.address.toLowerCase()}'].lastSignedWithdraw`);\n    if (wRes && wRes.length > 0) {\n      wRes = wRes[0];\n    }\n\n    // Withdraw token to account\n    const withdrawConfirmation = await tokenContract.withdraw(wRes.sender, wRes.amount, wRes.nonce, wRes.v, wRes.r, wRes.s);\n\n    eng = null;\n\n    console.log(\"Confirmation\", withdrawConfirmation);\n    return withdrawConfirmation;\n  }\n\n  /**\n   * Subscribe at the event\n   * @param {string} path\n   * @param func\n   * @returns {Promise<() => Promise<any>>}\n   */\n  public async subscribe(path: string, func) {\n    return this.subscribeMulti([path], func);\n  }\n\n  /**\n   * Subscribe at the multiple events\n   * @param {string} path\n   * @param func\n   * @returns {Promise<() => Promise<any>>}\n   */\n  public async subscribeMulti(path: string[], func) {\n\n    for (let i of path) {\n      const state = await this.refreshState(i);\n      const stateWatcher = new StateMergePatch(state, i);\n      this.states.set(i, stateWatcher);\n    }\n\n    const that = this;\n    const evtHandler = async () => {\n\n      that.states.forEach(async (value, key) => {\n        const result = await value.diff(that);\n        func(key, result);\n      });\n    };\n\n    const evt = await this.ulotion.subscribeTx(evtHandler);\n\n    return evtHandler;\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/main.ts","module.exports = require(\"altcoin-ethereum-wallet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"altcoin-ethereum-wallet\"\n// module id = 1\n// module chunks = 0","import * as Account from \"eth-lib/lib/account\";\nimport * as Hash from \"eth-lib/lib/hash\";\nimport * as Web3Utils from \"web3-utils\";\nimport { DepositDto } from '../dto/deposit.dto';\nimport * as HDKey from \"hdkey\";\n\nexport interface RawAccount {\n  privateKey: string;\n  address: string;\n}\n\nexport class EthereumAccount {\n\n  constructor(private account: RawAccount) {\n  }\n\n  get privateKey() {\n    return this.account.privateKey;\n  }\n\n  get address() {\n    return this.account.address;\n  }\n\n  /**\n   * Recover account from seed\n   * @param {string} seed\n   * @returns {EthereumAccount}\n   */\n  static recoverAccountFromSeed(seed: string): EthereumAccount {\n    const hdkey = new HDKey.fromMasterSeed(seed);\n    const hdnode = hdkey.derive(\"m/44'/60'/0'/0/0\");\n    const privateKey = hdnode._privateKey.toString(\"hex\");\n\n    const accounts = Account.accounts;\n    const acc = accounts.privateKeyToAccount(\"0x\" + privateKey);\n    return acc;\n  }\n\n  /**\n   * Recover account from private key\n   * @param {string} pk\n   * @returns {EthereumAccount}\n   */\n  static recoverAccount(pk: string): EthereumAccount {\n    return new EthereumAccount(Account.fromPrivate(\"0x\" + pk));\n  }\n\n  /**\n   * Sign receipt\n   * @param sender\n   * @param sellToken\n   * @param buyToken\n   * @param sellAmount\n   * @param buyAmount\n   * @param nonce\n   * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n   */\n  signReceiptTendermint(sender, sellToken, buyToken, sellAmount, buyAmount, nonce) {\n    const data = sender + sellToken + buyToken + this.hexValue(sellAmount) + this.hexValue(buyAmount) + this.hexValue(nonce);\n    const hash = this.hashMessage(data);\n    return this.signHash(data, hash);\n  }\n\n  /**\n   * Sign withdraw\n   * @param sender\n   * @param token\n   * @param amount\n   * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n   */\n  signWithdrawTendermint(sender, token, amount) {\n    const data = sender + token + this.hexValue(amount);\n    const hash = this.hashMessage(data);\n    return this.signHash(data, hash);\n  }\n\n  /**\n   * Sign receipt by parameters\n   * @param contractAddress\n   * @param value\n   * @param ticketNumber\n   * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n   */\n  signReceipt(contractAddress, value, ticketNumber) {\n    if (typeof value !== \"string\") {\n      throw new Error(\"value must be string\");\n    }\n\n    const data = contractAddress + this.hexValue(value) + this.hexValue(ticketNumber);\n    return this.sign(data);\n  }\n\n  /**\n   * To hex\n   * @param val\n   * @returns {string}\n   */\n  hexValue(val) {\n    return Web3Utils.asciiToHex(val).replace(\"0x\", \"\");\n  }\n\n  /**\n   * Sign hash\n   * @param data\n   * @param hash\n   * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n   */\n  signHash(data, hash) {\n    const signature = Account.sign(hash, this.privateKey);\n    const vrs = Account.decodeSignature(signature);\n\n    return {\n      message: data,\n      messageHash: hash,\n      v: vrs[0],\n      r: vrs[1],\n      s: vrs[2],\n      signature: signature\n    };\n  };\n\n  /**\n   * Sign data\n   * @param data\n   * @returns {{message: any; messageHash: any; v: any; r: any; s: any; signature: any}}\n   */\n  sign(data) {\n    const hash = this.hashMessage(data);\n\n    const signature = Account.sign(hash, this.privateKey);\n    const vrs = Account.decodeSignature(signature);\n\n    return {\n      message: data,\n      messageHash: hash,\n      v: vrs[0],\n      r: vrs[1],\n      s: vrs[2],\n      signature: signature\n    };\n  };\n\n  /**\n   * Hash message\n   * @param {string} data\n   * @returns {any}\n   */\n  public hashMessage(data: string) {\n    return Hash.keccak256s(data);\n  };\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/eth/ethereum-account.ts","module.exports = require(\"eth-lib/lib/account\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"eth-lib/lib/account\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"eth-lib/lib/hash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"eth-lib/lib/hash\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"web3-utils\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"web3-utils\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"hdkey\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"hdkey\"\n// module id = 6\n// module chunks = 0","import {ulotionHelper} from \"./ulotion-helper\";\nlet axios = require('axios');\nimport * as tendermint from'tendermint';\n\n\nexport class uLotion {\n\n  private nodes = [];\n  private eventRpc;\n\n  constructor(private GCI, private options) {\n    this.nodes = options.nodes;\n    if (!GCI) {\n      if (this.nodes === undefined || this.nodes.length === 0) {\n        throw Error('Nodes not set');\n      }\n    }\n  }\n\n  /**\n   * Get genesis active peer\n   * @returns {Promise<string>}\n   */\n  public async getGenesisActivePeer(): Promise<string> {\n    let rpcAddr;\n    if (this.GCI) {\n      // rpcAddr = this.nodes[0];\n      const genesis = await ulotionHelper.fetchGenesis(this.GCI);\n      rpcAddr = `http://${genesis.peer.host}:${this.options.tendermintPort}`;\n    } else {\n      rpcAddr = this.nodes[0]; //.replace('http:', 'ws:');\n    }\n    return rpcAddr;\n  }\n\n  /**\n   * Get state from tendermint client\n   * @param {string} path\n   * @returns {Promise<any>}\n   */\n  public async state(path = '') {\n\n    const rpcAddr = await this.getGenesisActivePeer();\n    const queryResponse = await axios.get(`${rpcAddr}/abci_query?path=\"${path}\"`);\n\n    if (queryResponse.data.error && !queryResponse.data.result) {\n      throw new Error(JSON.stringify(queryResponse.data.error));\n    }\n\n    let resp = queryResponse.data.result.response;\n    resp.height = Number(resp.height);\n\n    let value = null;\n    try {\n      value = JSON.parse(Buffer.from(resp.value, 'base64').toString());\n    } catch (e) {\n      throw new Error('invalid json in query response')\n    }\n\n    return value;\n  }\n\n  /**\n   * Send transaction\n   * @param tx\n   * @returns {Promise<any>}\n   */\n  public async send(tx) {\n\n      const rpcAddr = await this.getGenesisActivePeer();\n      // TODO: Remove after examination\n      // let nonce = Math.floor(Math.random() * (2 << 12));\n      // let txBytes = '0x' + ulotionHelper.encode(tx, nonce).toString('hex');\n      let txBytes = '0x' + Buffer.from(JSON.stringify(tx)).toString('hex');\n\n      const result = await axios.get(`${rpcAddr.replace(\n            'ws:',\n            'http:'\n          )}/broadcast_tx_commit`,\n          {\n            params: {\n              tx: txBytes\n            }\n          }\n        );\n\n      return result.data.result;\n  }\n\n  /**\n   * Subscribe to transaction event\n   * @param func\n   * @returns {Promise<void>}\n   */\n  public async subscribeTx(func) {\n\n    const rpcAddr = (await this.getGenesisActivePeer())\n      .replace('http:', 'ws:')\n      .replace('https:', 'wss:');\n\n    console.log(rpcAddr);\n\n    // TODO: Enable once tendermint package is properly packed\n    let rpc = tendermint.RpcClient(rpcAddr);\n    this.eventRpc = rpc;\n\n    rpc.on('close', e => {\n      console.log(e);\n    });\n\n    // console.log(rpc);\n    rpc.on('error', e => {\n      console.log('RPC Error: ', e);\n    });\n\n    rpc.subscribe({query: \"tm.event='Tx'\"}, func);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/services/ulotion.ts","import { createHash } from \"crypto-browserify\";\nconst stableStringify = require('json-stable-stringify');\n// const IPFS = require('ipfs');\n// const OrbitDB = require('orbit-db');\n// const discoveryChannel = require('discovery-channel');\n// const net = require('net');\n// const defaults = require('dat-swarm-defaults')();\nconst signalhub = require('signalhub');\nconst swarm = require('webrtc-swarm')\nconst vstruct = require('varstruct');\n\nlet TxStruct = vstruct([\n  { name: 'data', type: vstruct.VarString(vstruct.UInt32BE) },\n  { name: 'nonce', type: vstruct.UInt32BE },\n]);\n\nconst base64Prefix = ':base64:';\n\nexport class ulotionHelper {\n\n  private static convertBase64ToBuffers(obj) {\n    return ulotionHelper.replace(obj, ulotionHelper.bufferToBase64Replacer);\n  }\n\n  private static base64ToBufferReplacer(value) {\n    if (typeof value !== 'string') return value;\n    if (!value.startsWith(base64Prefix)) return value;\n    return Buffer.from(value.slice(base64Prefix.length), 'base64');\n  }\n\n  /**\n   * Encode transaction\n   * @param txData\n   * @param nonce\n   * @returns {any}\n   */\n  public static encode(txData, nonce) {\n    let data = ulotionHelper.stringify(txData);\n    let bytes = TxStruct.encode({ nonce, data });\n    return bytes;\n  }\n\n  public static fetchGenesis(GCI): Promise<any> {\n    return new Promise((resolve, reject) => {\n      let hub = signalhub(GCI, ['https://signalhub.altcoin.io']);\n      let sw;\n\n      // Check for environment\n      if (typeof process === 'object' && process + '' === '[object process]') {\n        sw = swarm(hub, { wrtc: require('wrtc') });\n      }\n      else{\n        sw = swarm(hub, {});\n      }\n\n      sw.on('peer', function(peer, id) {\n        peer.on('data', function(data) {\n          // full node writing to tell me what port to use for their tendermint rpc server\n          let port = Number(data.toString());\n          if (port > 100 && port < 65536) {\n            peer.destroy();\n            resolve({peer: { host: peer.remoteAddress, port: port}});\n          }\n        })\n      })\n    })\n  }\n\n  /**\n   * Get hash of the object\n   * @param obj\n   * @returns {any}\n   */\n  public static hash(obj) {\n    let hash = createHash('sha256');\n    let result = ulotionHelper.stringify(obj);\n    return hash.update(result, 'utf8').digest().toString('hex');\n  }\n\n  /**\n   * Parse string\n   * @param json\n   */\n  private static parse(json) {\n    let obj = JSON.parse(json);\n    return ulotionHelper.convertBase64ToBuffers(obj);\n  }\n\n  /**\n   * Get hash data from genesis\n   * @param genesis\n   */\n  private static getGCIFromGenesis(genesis) {\n    let hash = createHash('sha256');\n    // TODO: Check for genesisTime if needs to be hashed to get correct GCI\n    let genesisJson: any = ulotionHelper.parse(genesis);\n    genesisJson.genesis_time = \"\";\n    let genesisStr = ulotionHelper.stringify(genesisJson);\n    return hash.update(genesisStr, 'utf8').digest().toString('hex')\n  }\n\n  /**\n   * Clones an object\n   * @param obj\n   * @param replacer\n   * @returns {{}}\n   */\n  private static deepClone(obj, replacer) {\n    let newObj = Array.isArray(obj) ? [] : {};\n    Object.assign(newObj, obj);\n    for (let key in newObj) {\n      newObj[key] = replacer(newObj[key]);\n      if (typeof newObj[key] === 'object') {\n        newObj[key] = this.deepClone(newObj[key], replacer);\n      }\n    }\n    return newObj;\n  }\n\n  /**\n   * Replaces values in an object without cloning\n   * @param obj\n   * @param replacer\n   * @returns {any}\n   */\n  private static replace(obj, replacer) {\n    for (let key in obj) {\n      obj[key] = replacer(obj[key])\n      if (typeof obj[key] === 'object' && !Buffer.isBuffer(obj[key])) {\n        // recursively replace props of objects (unless it's a Buffer)\n        ulotionHelper.replace(obj[key], replacer)\n      }\n    }\n    return obj\n  }\n\n\n  /**\n   * Stringify obj\n   * @param obj\n   * @returns {any}\n   */\n  private static stringify(obj) {\n    let convertedObj = ulotionHelper.deepClone(obj, ulotionHelper.bufferToBase64Replacer);\n    return stableStringify(convertedObj)\n  }\n\n  /**\n   * Replace buffer to base64\n   * @param value\n   * @returns {any}\n   */\n  private static bufferToBase64Replacer(value) {\n    if (\n      typeof value === 'object' &&\n      value != null &&\n      value.type === 'Buffer' &&\n      Array.isArray(value.data)\n    ) {\n      value = Buffer.from(value)\n    }\n    if (!Buffer.isBuffer(value)) return value;\n    return `${base64Prefix}${value.toString('base64')}`\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/services/ulotion-helper.ts","module.exports = require(\"crypto-browserify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto-browserify\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"json-stable-stringify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"json-stable-stringify\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"signalhub\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"signalhub\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"webrtc-swarm\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webrtc-swarm\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"varstruct\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"varstruct\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"wrtc\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"wrtc\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"tendermint\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"tendermint\"\n// module id = 16\n// module chunks = 0","export const App = {\n  eth: {\n    wshost: \"wss://geth.altcoin.io\",\n    contractAddress: \"0xCe11e94E26D6fcB837F3E8a61C7c2e03523f4958\",\n    defaultWallet: \"0xb483f5a8c6ebA74Dc1bcef9D167E6B86Caa4C773\",\n  }\n};\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/config/main.config.ts","import {TokenMapping} from \"../main\";\n\nexport class StateHelper {\n\n  /**\n   * Map address to enum\n   * @param obj\n   * @param prop\n   */\n  public static mapAddressToEnum(obj, prop?) {\n    if (prop) {\n      for (const i in obj[prop]) {\n        if (obj[prop].hasOwnProperty(i)) {\n          obj[prop][TokenMapping[i.toLowerCase()]] = obj[prop][i];\n          delete obj[prop][i];\n        }\n      }\n    } else {\n      for (const arr in obj) {\n        if (obj.hasOwnProperty(arr)) {\n          for (const i in obj[arr]) {\n            if (obj[arr].hasOwnProperty(i)) {\n              obj[arr][TokenMapping[i.toLowerCase()]] = obj[arr][i];\n              delete obj[arr][i];\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/common/state-helper.ts","import * as diff from \"jsondiffpatch\";\nimport {LightClient} from \"../main\";\nimport {DiffPatcher} from \"jsondiffpatch\";\n\nexport class StateMergePatch {\n\n  private dp: DiffPatcher;\n  private state;\n\n  constructor(state, private path) {\n    this.dp = new DiffPatcher();\n    this.state = this.dp.clone(state);\n  }\n\n  /**\n   * Diff two states\n   * @param {LightClient} lc\n   * @returns {Promise<any>}\n   */\n  public async diff(lc: LightClient) {\n    const newState = await lc.refreshState(this.path);\n    const currentState =  this.dp.diff(this.state, newState);\n    this.state = newState;\n    return StateMergePatch.patchToMergePatch(currentState);\n  }\n\n  /**\n   * Check if key is numeric\n   * @param n\n   * @returns {boolean}\n   */\n  private static isNumeric(n) {\n    if (n.toLowerCase().startsWith(\"0x\")) {\n      return false;\n    }\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  }\n\n  /**\n   * Check if it has child array\n   * @param obj\n   * @returns {boolean}\n   */\n  private static isChildArray(obj) {\n    for (const i in obj) {\n      return StateMergePatch.isNumeric(i);\n    }\n  }\n\n  /**\n   * Create new object\n   * @param obj\n   * @returns {{}}\n   */\n  private static toObjType(obj) {\n    return StateMergePatch.isChildArray(obj) ? [] : {};\n  }\n\n  /**\n   * Handle array value\n   * @param val\n   * @returns {any}\n   */\n  private static handleValue(val) {\n    if (Array.isArray(val)) {\n      if (val.length > 1) {\n        return val[1];\n      }\n      return val[0];\n    }\n  }\n\n  /**\n   * Handle object\n   * @param key\n   * @param value\n   * @param result\n   */\n  private static handleObj(key, value, result) {\n\n    if (Array.isArray(value)) {\n      result[key] = StateMergePatch.handleValue(value);\n      return;\n    }\n\n    let obj = StateMergePatch.toObjType(value);\n\n    if (Array.isArray(result)) {\n      result.push(obj);\n    } else {\n      result[key] = obj;\n    }\n    StateMergePatch.patchToMergePatch(value, obj);\n  }\n\n  /**\n   * Convert patch to merge patch\n   * TODO: Refactor\n   * @param patch\n   * @param result\n   * @returns {any}\n   */\n  public static patchToMergePatch(patch, result?) {\n\n    for (const i in patch) {\n\n      // Is array\n      if (StateMergePatch.isNumeric(i)) {\n        if (result === undefined) {\n          result = [];\n        }\n\n        if (typeof patch[i] === \"string\") {\n          result.push(patch[i]);\n        } else if (typeof patch[i] == \"object\") {\n          this.handleObj(i, patch[i], result);\n        } else if (Array.isArray(patch[i])) {\n          result.push(StateMergePatch.handleValue(patch[i]));\n        }\n\n      } else {\n        if (result === undefined) {\n          result = StateMergePatch.toObjType(patch[i]);\n        }\n\n        if (typeof patch[i] === \"string\") {\n          result[i] = patch[i];\n        } else if (typeof patch[i] == \"object\") {\n          this.handleObj(i, patch[i], result);\n        } else if (Array.isArray(patch[i])) {\n          result[i] = StateMergePatch.handleValue(patch[i]);\n        }\n      }\n    }\n\n    return result;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/tslint-loader!./src/main/common/state-merge-patch.ts","module.exports = require(\"jsondiffpatch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsondiffpatch\"\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}